{% include 'navbar.html' %}
{% block content %}

<style>
 .form-container { width: 450px; margin: -45px auto; background: #fff; padding: 32px 28px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); text-align: left; } .form-container h2 { text-align: center; font-size: 22px; font-weight: 600; margin-bottom: 25px; } label { display: block; font-weight: 500; margin-bottom: 6px; color: #222; } label span { color: red; } input, select { width: 100%; padding: 10px 12px; margin-bottom: 18px; border: 1px solid #ddd; border-radius: 8px; font-size: 15px; outline: none; transition: border-color 0.2s, box-shadow 0.2s; } input:focus, select:focus { border-color: #007bff; box-shadow: 0 0 0 2px rgba(0,123,255,0.15); } .button { width: 100%; background-color: #007bff; color: #fff; padding: 12px 0; font-size: 15px; font-weight: 600; border: none; border-radius: 8px; cursor: pointer; transition: background 0.2s ease; } .button:hover { background-color: #0056d2; } .message { color: green; text-align: center; }
</style>

<div class="form-container">
  <h2>Add New Transaction</h2>

  {% if messages %}
  {% for message in messages %}
    <p class="message">{{ message }}</p>
  {% endfor %}
{% endif %}


  <form method="POST" action={% url "add_transaction" %}>
    {% csrf_token %}

    <label for="type">Transaction Type <span>*</span></label>
    <select name="type" id="type" required>
      <option value="" selected disabled>Select Type</option>
      <option value="Expense">Expense</option>
      <option value="Income">Income</option>
    </select>

    <label for="category">Category <span>*</span></label>
    <select name="category" id="category" required>
      <option value="" selected disabled>Select Category</option>

      {% for category in expense_categories %}
        <option value="{{ category.name }}" data-type="Expense" hidden>{{ category.name }}</option>
      {% endfor %}

      {% for category in income_categories %}
        <option value="{{ category.name }}" data-type="Income" hidden>{{ category.name }}</option>
      {% endfor %}
    </select>

    <label for="title">Title <span>*</span></label>
    <input type="text" name="title" id="title" placeholder="Enter transaction title" required>

    <label for="amount">Amount (₹) <span>*</span></label>
    <input type="number" name="amount" id="amount" min="1" step="0.01" placeholder="₹0.00" required>

    <label for="date">Date <span>*</span></label>
    <input type="date" name="date" id="date" required>

    <input type="submit" class="button" value="Add Transaction">
  </form>
</div>

<footer class="footer">
  <p class="footer-text">&copy; 2023 Finance Tracker. All rights reserved.</p>
</footer>

<script>
  const typeSelect = document.getElementById('type');
  const categorySelect = document.getElementById('category');

  function filterCategories() {
    let selectedType = typeSelect.value;

    Array.from(categorySelect.options).forEach(option => {
      if (!option.dataset.type) return;
      option.hidden = option.dataset.type !== selectedType;
    });

    categorySelect.value = "";
  }

  typeSelect.addEventListener("change", filterCategories);
</script>

{% endblock %}
